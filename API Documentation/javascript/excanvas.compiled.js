// Copyright 2006 Google Inc.
document.createElement("canvas").getContext||function(){function e(){return this.context_||(this.context_=new c(this))}function t(e,t){var i=C.call(arguments,2);return function(){return e.apply(t,i.concat(C.call(arguments)))}}function i(e){var t=e.srcElement;switch(e.propertyName){case"width":t.style.width=t.attributes.width.nodeValue+"px",t.getContext().clearRect();break;case"height":t.style.height=t.attributes.height.nodeValue+"px",t.getContext().clearRect()}}function n(e){var t=e.srcElement;t.firstChild&&(t.firstChild.style.width=t.clientWidth+"px",t.firstChild.style.height=t.clientHeight+"px")}function r(){return[[1,0,0],[0,1,0],[0,0,1]]}function o(e,t){for(var i=r(),n=0;3>n;n++)for(var o=0;3>o;o++){for(var a=0,s=0;3>s;s++)a+=e[n][s]*t[s][o];i[n][o]=a}return i}function a(e,t){t.fillStyle=e.fillStyle,t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.shadowBlur=e.shadowBlur,t.shadowColor=e.shadowColor,t.shadowOffsetX=e.shadowOffsetX,t.shadowOffsetY=e.shadowOffsetY,t.strokeStyle=e.strokeStyle,t.globalAlpha=e.globalAlpha,t.arcScaleX_=e.arcScaleX_,t.arcScaleY_=e.arcScaleY_,t.lineScale_=e.lineScale_}function s(e){var t,i=1;if(e=String(e),"rgb"==e.substring(0,3)){var n=e.indexOf("(",3),r=e.indexOf(")",n+1),o=e.substring(n+1,r).split(",");t="#";for(var a=0;3>a;a++)t+=_[Number(o[a])];4==o.length&&"a"==e.substr(3,1)&&(i=o[3])}else t=e;return{color:t,alpha:i}}function l(e){switch(e){case"butt":return"flat";case"round":return"round";case"square":default:return"square"}}function c(e){this.m_=r(),this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.fillStyle=this.strokeStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*x,this.globalAlpha=1,this.canvas=e;var t=e.ownerDocument.createElement("div");t.style.width=e.clientWidth+"px",t.style.height=e.clientHeight+"px",t.style.overflow="hidden",t.style.position="absolute",e.appendChild(t),this.element_=t,this.lineScale_=this.arcScaleY_=this.arcScaleX_=1}function u(e,t,i,n){e.currentPath_.push({type:"bezierCurveTo",cp1x:t.x,cp1y:t.y,cp2x:i.x,cp2y:i.y,x:n.x,y:n.y}),e.currentX_=n.x,e.currentY_=n.y}function h(e){for(var t=0;3>t;t++)for(var i=0;2>i;i++)if(!isFinite(e[t][i])||isNaN(e[t][i]))return!1;return!0}function d(e,t,i){h(t)&&(e.m_=t,i&&(e.lineScale_=w(b(t[0][0]*t[1][1]-t[0][1]*t[1][0]))))}function p(e){this.type_=e,this.r1_=this.y1_=this.x1_=this.r0_=this.y0_=this.x0_=0,this.colors_=[]}function f(){}var m=Math,g=m.round,v=m.sin,y=m.cos,b=m.abs,w=m.sqrt,x=10,k=x/2,C=Array.prototype.slice,T={init:function(e){if(/MSIE/.test(navigator.userAgent)&&!window.opera){var i=e||document;i.createElement("canvas"),i.attachEvent("onreadystatechange",t(this.init_,this,i))}},init_:function(e){if(e.namespaces.g_vml_||e.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml","#default#VML"),e.namespaces.g_o_||e.namespaces.add("g_o_","urn:schemas-microsoft-com:office:office","#default#VML"),!e.styleSheets.ex_canvas_){var t=e.createStyleSheet();t.owningElement.id="ex_canvas_",t.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}g_o_\\:*{behavior:url(#default#VML)}"}for(var i=e.getElementsByTagName("canvas"),n=0;n<i.length;n++)this.initElement(i[n])},initElement:function(t){if(!t.getContext){t.getContext=e,t.innerHTML="",t.attachEvent("onpropertychange",i),t.attachEvent("onresize",n);var r=t.attributes;r.width&&r.width.specified?t.style.width=r.width.nodeValue+"px":t.width=t.clientWidth,r.height&&r.height.specified?t.style.height=r.height.nodeValue+"px":t.height=t.clientHeight}return t}};T.init();for(var _=[],S=0;16>S;S++)for(var A=0;16>A;A++)_[16*S+A]=S.toString(16)+A.toString(16);var L=c.prototype;L.clearRect=function(){this.element_.innerHTML=""},L.beginPath=function(){this.currentPath_=[]},L.moveTo=function(e,t){var i=this.getCoords_(e,t);this.currentPath_.push({type:"moveTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},L.lineTo=function(e,t){var i=this.getCoords_(e,t);this.currentPath_.push({type:"lineTo",x:i.x,y:i.y}),this.currentX_=i.x,this.currentY_=i.y},L.bezierCurveTo=function(e,t,i,n,r,o){var a=this.getCoords_(r,o),s=this.getCoords_(e,t),l=this.getCoords_(i,n);u(this,s,l,a)},L.quadraticCurveTo=function(e,t,i,n){var r=this.getCoords_(e,t),o=this.getCoords_(i,n),a={x:this.currentX_+.6666666666666666*(r.x-this.currentX_),y:this.currentY_+.6666666666666666*(r.y-this.currentY_)};u(this,a,{x:a.x+(o.x-this.currentX_)/3,y:a.y+(o.y-this.currentY_)/3},o)},L.arc=function(e,t,i,n,r,o){i*=x;var a=o?"at":"wa",s=e+y(n)*i-k,l=t+v(n)*i-k,c=e+y(r)*i-k,u=t+v(r)*i-k;s!=c||o||(s+=.125);var h=this.getCoords_(e,t),d=this.getCoords_(s,l),p=this.getCoords_(c,u);this.currentPath_.push({type:a,x:h.x,y:h.y,radius:i,xStart:d.x,yStart:d.y,xEnd:p.x,yEnd:p.y})},L.rect=function(e,t,i,n){this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+n),this.lineTo(e,t+n),this.closePath()},L.strokeRect=function(e,t,i,n){var r=this.currentPath_;this.beginPath(),this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+n),this.lineTo(e,t+n),this.closePath(),this.stroke(),this.currentPath_=r},L.fillRect=function(e,t,i,n){var r=this.currentPath_;this.beginPath(),this.moveTo(e,t),this.lineTo(e+i,t),this.lineTo(e+i,t+n),this.lineTo(e,t+n),this.closePath(),this.fill(),this.currentPath_=r},L.createLinearGradient=function(e,t,i,n){var r=new p("gradient");return r.x0_=e,r.y0_=t,r.x1_=i,r.y1_=n,r},L.createRadialGradient=function(e,t,i,n,r,o){var a=new p("gradientradial");return a.x0_=e,a.y0_=t,a.r0_=i,a.x1_=n,a.y1_=r,a.r1_=o,a},L.drawImage=function(e){var t,i,n,r,o,a,s,l,c=e.runtimeStyle.width,u=e.runtimeStyle.height;e.runtimeStyle.width="auto",e.runtimeStyle.height="auto";var h=e.width,d=e.height;if(e.runtimeStyle.width=c,e.runtimeStyle.height=u,3==arguments.length)t=arguments[1],i=arguments[2],o=a=0,s=n=h,l=r=d;else if(5==arguments.length)t=arguments[1],i=arguments[2],n=arguments[3],r=arguments[4],o=a=0,s=h,l=d;else{if(9!=arguments.length)throw Error("Invalid number of arguments");o=arguments[1],a=arguments[2],s=arguments[3],l=arguments[4],t=arguments[5],i=arguments[6],n=arguments[7],r=arguments[8]}var p=this.getCoords_(t,i),f=[];if(f.push(" <g_vml_:group",' coordsize="',10*x,",",10*x,'"',' coordorigin="0,0"',' style="width:',10,"px;height:",10,"px;position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]){var v=[];v.push("M11=",this.m_[0][0],",","M12=",this.m_[1][0],",","M21=",this.m_[0][1],",","M22=",this.m_[1][1],",","Dx=",g(p.x/x),",","Dy=",g(p.y/x),"");var y=p,b=this.getCoords_(t+n,i),w=this.getCoords_(t,i+r),k=this.getCoords_(t+n,i+r);y.x=m.max(y.x,b.x,w.x,k.x),y.y=m.max(y.y,b.y,w.y,k.y),f.push("padding:0 ",g(y.x/x),"px ",g(y.y/x),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",v.join(""),", sizingmethod='clip');")}else f.push("top:",g(p.y/x),"px;left:",g(p.x/x),"px;");f.push(' ">','<g_vml_:image src="',e.src,'"',' style="width:',x*n,"px;"," height:",x*r,'px;"',' cropleft="',o/h,'"',' croptop="',a/d,'"',' cropright="',(h-o-s)/h,'"',' cropbottom="',(d-a-l)/d,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",f.join(""))},L.stroke=function(e){var t=[],i=s(e?this.fillStyle:this.strokeStyle),n=i.color,r=i.alpha*this.globalAlpha;t.push("<g_vml_:shape",' filled="',!!e,'"',' style="position:absolute;width:',10,"px;height:",10,'px;"',' coordorigin="0 0" coordsize="',10*x," ",10*x,'"',' stroked="',!e,'"',' path="');for(var o={x:null,y:null},a={x:null,y:null},c=0;c<this.currentPath_.length;c++){var u=this.currentPath_[c];switch(u.type){case"moveTo":t.push(" m ",g(u.x),",",g(u.y));break;case"lineTo":t.push(" l ",g(u.x),",",g(u.y));break;case"close":t.push(" x "),u=null;break;case"bezierCurveTo":t.push(" c ",g(u.cp1x),",",g(u.cp1y),",",g(u.cp2x),",",g(u.cp2y),",",g(u.x),",",g(u.y));break;case"at":case"wa":t.push(" ",u.type," ",g(u.x-this.arcScaleX_*u.radius),",",g(u.y-this.arcScaleY_*u.radius)," ",g(u.x+this.arcScaleX_*u.radius),",",g(u.y+this.arcScaleY_*u.radius)," ",g(u.xStart),",",g(u.yStart)," ",g(u.xEnd),",",g(u.yEnd))}u&&((null==o.x||u.x<o.x)&&(o.x=u.x),(null==a.x||u.x>a.x)&&(a.x=u.x),(null==o.y||u.y<o.y)&&(o.y=u.y),(null==a.y||u.y>a.y)&&(a.y=u.y))}if(t.push(' ">'),e)if("object"==typeof this.fillStyle){var h=this.fillStyle,d=0,p={x:0,y:0},f=0,v=1;if("gradient"==h.type_){var y=h.x1_/this.arcScaleX_,b=h.y1_/this.arcScaleY_,w=this.getCoords_(h.x0_/this.arcScaleX_,h.y0_/this.arcScaleY_),k=this.getCoords_(y,b);d=180*Math.atan2(k.x-w.x,k.y-w.y)/Math.PI,0>d&&(d+=360),1e-6>d&&(d=0)}else{var w=this.getCoords_(h.x0_,h.y0_),C=a.x-o.x,T=a.y-o.y;p={x:(w.x-o.x)/C,y:(w.y-o.y)/T},C/=this.arcScaleX_*x,T/=this.arcScaleY_*x;var _=m.max(C,T);f=2*h.r0_/_,v=2*h.r1_/_-f}var S=h.colors_;S.sort(function(e,t){return e.offset-t.offset});for(var A=S.length,L=S[0].color,N=S[A-1].color,M=S[0].alpha*this.globalAlpha,P=S[A-1].alpha*this.globalAlpha,j=[],c=0;A>c;c++){var $=S[c];j.push($.offset*v+f+" "+$.color)}t.push('<g_vml_:fill type="',h.type_,'"',' method="none" focus="100%"',' color="',L,'"',' color2="',N,'"',' colors="',j.join(","),'"',' opacity="',P,'"',' g_o_:opacity2="',M,'"',' angle="',d,'"',' focusposition="',p.x,",",p.y,'" />')}else t.push('<g_vml_:fill color="',n,'" opacity="',r,'" />');else{var I=this.lineScale_*this.lineWidth;1>I&&(r*=I),t.push("<g_vml_:stroke",' opacity="',r,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',l(this.lineCap),'"',' weight="',I,'px"',' color="',n,'" />')}t.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",t.join(""))},L.fill=function(){this.stroke(!0)},L.closePath=function(){this.currentPath_.push({type:"close"})},L.getCoords_=function(e,t){var i=this.m_;return{x:x*(e*i[0][0]+t*i[1][0]+i[2][0])-k,y:x*(e*i[0][1]+t*i[1][1]+i[2][1])-k}},L.save=function(){var e={};a(this,e),this.aStack_.push(e),this.mStack_.push(this.m_),this.m_=o(r(),this.m_)},L.restore=function(){a(this.aStack_.pop(),this),this.m_=this.mStack_.pop()},L.translate=function(e,t){d(this,o([[1,0,0],[0,1,0],[e,t,1]],this.m_),!1)},L.rotate=function(e){var t=y(e),i=v(e);d(this,o([[t,i,0],[-i,t,0],[0,0,1]],this.m_),!1)},L.scale=function(e,t){this.arcScaleX_*=e,this.arcScaleY_*=t,d(this,o([[e,0,0],[0,t,0],[0,0,1]],this.m_),!0)},L.transform=function(e,t,i,n,r,a){d(this,o([[e,t,0],[i,n,0],[r,a,1]],this.m_),!0)},L.setTransform=function(e,t,i,n,r,o){d(this,[[e,t,0],[i,n,0],[r,o,1]],!0)},L.clip=function(){},L.arcTo=function(){},L.createPattern=function(){return new f},p.prototype.addColorStop=function(e,t){t=s(t),this.colors_.push({offset:e,color:t.color,alpha:t.alpha})},G_vmlCanvasManager=T,CanvasRenderingContext2D=c,CanvasGradient=p,CanvasPattern=f}();